{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/medse/Desktop/Fraud_Detect/fraud_detection/src/app/Pages/Client/AddTransaction/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\nimport { ArrowLeft } from \"lucide-react\";\r\n\r\ntype TxType = \"debit\" | \"credit\" | \"transfer\" | \"payment\" | \"other\";\r\ntype Channel = \"online\" | \"branch\" | \"atm\" | \"pos\" | \"mobile\";\r\n\r\nconst DEFAULT_API =\r\n  typeof window !== \"undefined\" && \"__NEXT_DATA__\" in window\r\n    ? (process.env.NEXT_PUBLIC_API_URL as string) || \"http://localhost:4000/api\"\r\n    : (process?.env?.NEXT_PUBLIC_API_URL as string) || \"http://localhost:4000/api\";\r\n\r\nexport default function AddTransactionPage() {\r\n  const router = useRouter();\r\n  const [amount, setAmount] = useState<number | \"\">(\"\");\r\n  const [type, setType] = useState<TxType>(\"debit\");\r\n  const [channel, setChannel] = useState<Channel>(\"online\");\r\n  const [date, setDate] = useState<string>(new Date().toISOString().slice(0, 16)); // yyyy-mm-ddThh:mm\r\n  const [description, setDescription] = useState<string>(\"\");\r\n  const [balanceAfter, setBalanceAfter] = useState<number | \"\">(\"\");\r\n  const [compteSource, setCompteSource] = useState<string>(\"\");\r\n  const [compteDestination, setCompteDestination] = useState<string>(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const API_URL = (process.env.NEXT_PUBLIC_API_URL as string) || DEFAULT_API;\r\n\r\n  function validate() {\r\n    if (amount === \"\" || Number.isNaN(Number(amount))) {\r\n      alert(\"Please enter a valid amount\");\r\n      return false;\r\n    }\r\n    if (!date) {\r\n      alert(\"Please select a date\");\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  async function handleSubmit(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    if (!validate()) return;\r\n    setLoading(true);\r\n\r\n    // Build payload according to backend expectation\r\n    const payload = {\r\n      date: new Date(date).toISOString(),\r\n      amount: Number(amount),\r\n      type,\r\n      channel,\r\n      description,\r\n      balanceAfter: balanceAfter === \"\" ? undefined : Number(balanceAfter),\r\n      compteSource: compteSource || undefined,\r\n      compteDestination: compteDestination || undefined,\r\n    };\r\n\r\n    try {\r\n      const token = typeof window !== \"undefined\" ? localStorage.getItem(\"token\") : null;\r\n      const res = await fetch(`${API_URL}/transactions`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          ...(token ? { Authorization: `Bearer ${token}` } : {}),\r\n        },\r\n        body: JSON.stringify(payload),\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const err = await res.json().catch(() => null);\r\n        throw new Error(err?.message || `HTTP ${res.status}`);\r\n      }\r\n\r\n      await res.json();\r\n      // success\r\n      alert(\"Transaction added successfully\");\r\n      router.push(\"/Transaction\");\r\n    } catch (error: unknown) {\r\n      console.error(\"Add transaction error:\", error);\r\n      const message = error instanceof Error ? error.message : String(error);\r\n      alert(\"Error creating transaction: \" + message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen p-8\">\r\n      <main className=\"flex-1 p-8\">\r\n        <div className=\"max-w-3xl mx-auto\">\r\n          <div className=\"flex items-center justify-between mb-6\">\r\n            <h2 className=\"text-2xl font-semibold text-blue-900\">Add Transaction</h2>\r\n            <Link href=\"./Transaction\">\r\n              <button className=\"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300\">\r\n                <Arrowleft className=\"inline-block mr-2 h-5 w-5\" />\r\n                Back to list\r\n              </button>\r\n            </Link>\r\n          </div>\r\n\r\n          <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded-xl shadow space-y-4\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <label className=\"flex flex-col\">\r\n                <span className=\"text-sm text-gray-600\">Amount</span>\r\n                <input\r\n                  type=\"number\"\r\n                  step=\"0.01\"\r\n                  value={amount}\r\n                  onChange={(e) => setAmount(e.target.value === \"\" ? \"\" : Number(e.target.value))}\r\n                  className=\"mt-1 p-2 border rounded text-gray-900\"\r\n                  placeholder=\"e.g. 1250.00\"\r\n                  required\r\n                />\r\n              </label>\r\n\r\n              <label className=\"flex flex-col\">\r\n                <span className=\"text-sm text-gray-600\">Date & time</span>\r\n                <input\r\n                  type=\"datetime-local\"\r\n                  value={date}\r\n                  onChange={(e) => setDate(e.target.value)}\r\n                  className=\"mt-1 p-2 border rounded text-gray-900\"\r\n                  required\r\n                />\r\n              </label>\r\n\r\n              <label className=\"flex flex-col\">\r\n                <span className=\"text-sm text-gray-600\">Type</span>\r\n                <select\r\n                  value={type}\r\n                  onChange={(e) => setType(e.target.value as TxType)}\r\n                  className=\"mt-1 p-2 border rounded text-gray-900\"\r\n                >\r\n                  <option value=\"debit\">Debit</option>\r\n                  <option value=\"credit\">Credit</option>\r\n                  <option value=\"transfer\">Transfer</option>\r\n                  <option value=\"payment\">Payment</option>\r\n                  <option value=\"other\">Other</option>\r\n                </select>\r\n              </label>\r\n\r\n              <label className=\"flex flex-col\">\r\n                <span className=\"text-sm text-gray-600\">Channel</span>\r\n                <select\r\n                  value={channel}\r\n                  onChange={(e) => setChannel(e.target.value as Channel)}\r\n                  className=\"mt-1 p-2 border rounded text-gray-900\"\r\n                >\r\n                  <option value=\"online\">Online</option>\r\n                  <option value=\"branch\">Branch</option>\r\n                  <option value=\"atm\">ATM</option>\r\n                  <option value=\"pos\">POS</option>\r\n                  <option value=\"mobile\">Mobile</option>\r\n                </select>\r\n              </label>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <label className=\"flex flex-col\">\r\n                <span className=\"text-sm text-gray-600\">Source Account (optional)</span>\r\n                <input\r\n                  value={compteSource}\r\n                  onChange={(e) => setCompteSource(e.target.value)}\r\n                  className=\"mt-1 p-2 border rounded text-gray-900\"\r\n                  placeholder=\"account id or number\"\r\n                />\r\n              </label>\r\n\r\n              <label className=\"flex flex-col\">\r\n                <span className=\"text-sm text-gray-600\">Destination Account (optional)</span>\r\n                <input\r\n                  value={compteDestination}\r\n                  onChange={(e) => setCompteDestination(e.target.value)}\r\n                  className=\"mt-1 p-2 border rounded text-gray-900\"\r\n                  placeholder=\"account id or number\"\r\n                />\r\n              </label>\r\n            </div>\r\n\r\n            <label className=\"flex flex-col\">\r\n              <span className=\"text-sm text-gray-600\">Description</span>\r\n              <textarea\r\n                value={description}\r\n                onChange={(e) => setDescription(e.target.value)}\r\n                className=\"mt-1 p-2 border rounded text-gray-900\"\r\n                rows={3}\r\n                placeholder=\"Optional note about the transaction\"\r\n              />\r\n            </label>\r\n\r\n            <label className=\"flex flex-col md:w-1/2\">\r\n              <span className=\"text-sm text-gray-600\">Balance After (optional)</span>\r\n              <input\r\n                type=\"number\"\r\n                step=\"0.01\"\r\n                value={balanceAfter}\r\n                onChange={(e) => setBalanceAfter(e.target.value === \"\" ? \"\" : Number(e.target.value))}\r\n                className=\"mt-1 p-2 border rounded text-gray-900\"\r\n                placeholder=\"e.g. 5000.00\"\r\n              />\r\n            </label>\r\n\r\n            <div className=\"flex items-center gap-3 mt-4\">\r\n              <button\r\n                type=\"submit\"\r\n                disabled={loading}\r\n                className=\"px-4 py-2 bg-blue-700 text-white rounded hover:bg-blue-600 disabled:opacity-60\"\r\n              >\r\n                {loading ? \"Saving...\" : \"Save Transaction\"}\r\n              </button>\r\n\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => router.push(\"/Transaction\")}\r\n                className=\"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300\"\r\n              >\r\n                Cancel\r\n              </button>\r\n            </div>\r\n\r\n            {/* Preview */}\r\n            <div className=\"mt-6 p-4 bg-gray-50 rounded border\">\r\n              <h4 className=\"font-semibold text-gray-800 mb-2\">Preview</h4>\r\n              <div className=\"text-gray-700\">\r\n                <p>\r\n                  <span className=\"font-medium\">Amount:</span> {amount === \"\" ? \"-\" : `$${Number(amount).toFixed(2)}`}\r\n                </p>\r\n                <p>\r\n                  <span className=\"font-medium\">Type:</span> {type}\r\n                </p>\r\n                <p>\r\n                  <span className=\"font-medium\">Channel:</span> {channel}\r\n                </p>\r\n                <p>\r\n                  <span className=\"font-medium\">Date:</span> {date ? new Date(date).toLocaleString() : \"-\"}\r\n                </p>\r\n                <p>\r\n                  <span className=\"font-medium\">Description:</span> {description || \"-\"}\r\n                </p>\r\n                <p>\r\n                  <span className=\"font-medium\">Balance After:</span>{\" \"}\r\n                  {balanceAfter === \"\" ? \"-\" : `$${Number(balanceAfter).toFixed(2)}`}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}}]
}