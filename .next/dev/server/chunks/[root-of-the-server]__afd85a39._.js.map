{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/medse/Desktop/Fraud_Detect/fraud_detection/src/lib/mongodb.ts"],"sourcesContent":[" import mongoose from \"mongoose\";\r\n\r\n const MONGODB_URI = process.env.MONGODB_URI || \"mongodb://127.0.0.1:27017/FDS\";\r\n if (!MONGODB_URI) {\r\n    throw new Error(\"❌ Please add your MongoDB URI to .env.local\");\r\n }\r\n let isConnected = false;\r\n export async function dbConnect() {\r\n    if (isConnected) return;\r\n    try {\r\n        await mongoose.connect(MONGODB_URI);\r\n        isConnected = true;\r\n        console.log(\"✅MongoDB connected\");\r\n    } catch (error) {\r\n        console.error(\"❌ MongoDB connection error\", error);\r\n        throw error;\r\n    }\r\n}"],"names":[],"mappings":";;;;AAAC;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW,IAAI;AAC/C;;AAGA,IAAI,cAAc;AACX,eAAe;IACnB,IAAI,aAAa;IACjB,IAAI;QACA,MAAM,oHAAQ,CAAC,OAAO,CAAC;QACvB,cAAc;QACd,QAAQ,GAAG,CAAC;IAChB,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,MAAM;IACV;AACJ"}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/medse/Desktop/Fraud_Detect/fraud_detection/src/Models/Transaction.ts"],"sourcesContent":["import mongoose from 'mongoose';\r\n\r\n// inline enums (was imported from './enums')\r\nenum TypeTransaction {\r\n  OTHER = 'OTHER',\r\n  TRANSFER = 'TRANSFER',\r\n  PAYMENT = 'PAYMENT',\r\n  WITHDRAWAL = 'WITHDRAWAL',\r\n  DEPOSIT = 'DEPOSIT'\r\n}\r\n\r\nenum StatutTransaction {\r\n  EN_ATTENTE = 'EN_ATTENTE',\r\n  VALIDE = 'VALIDE',\r\n  REJETE = 'REJETE'\r\n}\r\n\r\nconst TransactionSchema = new mongoose.Schema({\r\n  idTransaction: { type: Number }, // optional external id\r\n  step: { type: Number, default: 0 }, // snapshot step for dataset alignment\r\n  user: { type: mongoose.Schema.Types.ObjectId, ref: 'User' }, // owner\r\n  compteSource: { type: mongoose.Schema.Types.ObjectId, ref: 'Compte' },\r\n  compteDestination: { type: mongoose.Schema.Types.ObjectId, ref: 'Compte' },\r\n  date: { type: Date, required: true, default: Date.now },\r\n  amount: { type: Number, required: true },\r\n  type: { type: String, enum: Object.values(TypeTransaction), default: TypeTransaction.OTHER },\r\n  channel: { type: String, enum: ['online','branch','atm','pos','mobile'], default: 'online' },\r\n  statut: { type: String, enum: Object.values(StatutTransaction), default: StatutTransaction.EN_ATTENTE },\r\n  isFraud: { type: Boolean, default: false },\r\n  riskScore: { type: Number, default: 0 },\r\n  mlDetails: { type: mongoose.Schema.Types.Mixed }, // store ML output & features\r\n  description: { type: String },\r\n  balanceAfterSource: { type: Number },\r\n  balanceAfterDestination: { type: Number },\r\n  createdAt: { type: Date, default: Date.now }\r\n});\r\n\r\n// helpers\r\n// TransactionSchema.methods.markAsFraud = function(score, details){\r\n//   this.isFraud = true;\r\n//   this.riskScore = score || this.riskScore;\r\n//   if(details) this.mlDetails = Object.assign(this.mlDetails || {}, details);\r\n//   return this.save();\r\n// };\r\n\r\nconst Transaction = mongoose.model('Transaction', TransactionSchema);\r\nexport default mongoose.models.Transaction || Transaction;"],"names":[],"mappings":";;;;AAAA;;AAEA,6CAA6C;AAC7C,IAAA,AAAK,yCAAA;;;;;;WAAA;EAAA;AAQL,IAAA,AAAK,2CAAA;;;;WAAA;EAAA;AAML,MAAM,oBAAoB,IAAI,oHAAQ,CAAC,MAAM,CAAC;IAC5C,eAAe;QAAE,MAAM;IAAO;IAC9B,MAAM;QAAE,MAAM;QAAQ,SAAS;IAAE;IACjC,MAAM;QAAE,MAAM,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;IAAO;IAC1D,cAAc;QAAE,MAAM,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;IAAS;IACpE,mBAAmB;QAAE,MAAM,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;IAAS;IACzE,MAAM;QAAE,MAAM;QAAM,UAAU;QAAM,SAAS,KAAK,GAAG;IAAC;IACtD,QAAQ;QAAE,MAAM;QAAQ,UAAU;IAAK;IACvC,MAAM;QAAE,MAAM;QAAQ,MAAM,OAAO,MAAM,CAAC;QAAkB,OAAO;IAAwB;IAC3F,SAAS;QAAE,MAAM;QAAQ,MAAM;YAAC;YAAS;YAAS;YAAM;YAAM;SAAS;QAAE,SAAS;IAAS;IAC3F,QAAQ;QAAE,MAAM;QAAQ,MAAM,OAAO,MAAM,CAAC;QAAoB,OAAO;IAA+B;IACtG,SAAS;QAAE,MAAM;QAAS,SAAS;IAAM;IACzC,WAAW;QAAE,MAAM;QAAQ,SAAS;IAAE;IACtC,WAAW;QAAE,MAAM,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK;IAAC;IAC/C,aAAa;QAAE,MAAM;IAAO;IAC5B,oBAAoB;QAAE,MAAM;IAAO;IACnC,yBAAyB;QAAE,MAAM;IAAO;IACxC,WAAW;QAAE,MAAM;QAAM,SAAS,KAAK,GAAG;IAAC;AAC7C;AAEA,UAAU;AACV,oEAAoE;AACpE,yBAAyB;AACzB,8CAA8C;AAC9C,+EAA+E;AAC/E,wBAAwB;AACxB,KAAK;AAEL,MAAM,cAAc,oHAAQ,CAAC,KAAK,CAAC,eAAe;uCACnC,oHAAQ,CAAC,MAAM,CAAC,WAAW,IAAI"}},
    {"offset": {"line": 180, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/medse/Desktop/Fraud_Detect/fraud_detection/src/app/api/Client/Transaction/route.ts"],"sourcesContent":["import { dbConnect } from \"@/lib/mongodb\";\r\nimport Transaction from \"@/Models/Transaction\";\r\n\r\n\r\nexport async function POST(req: Request) {\r\n  try {\r\n    await dbConnect();\r\n    const { date, amount, type, channel, description, balanceAfter, compteSource, compteDestination } = await req.json();\r\n\r\n    if (!date || !amount || !type || !channel) {\r\n      return new Response(JSON.stringify({ error: \"Missing required fields\" }), {\r\n        status: 400,\r\n      });\r\n    }\r\n    \r\n    const newTransaction = new Transaction({\r\n      date,\r\n      amount,\r\n      type,\r\n      channel,\r\n      description,\r\n      balanceAfter,\r\n      compteSource,\r\n      compteDestination,\r\n    });\r\n\r\n    await newTransaction.save();\r\n\r\n    return new Response(JSON.stringify({ message: \"Transaction created successfully\" }), {\r\n      status: 201,\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Transaction error:\", error);\r\n    return new Response(\r\n      JSON.stringify({\r\n        error: \"Something went wrong\",\r\n        details: error instanceof Error ? error.message : \"Unknown error\",\r\n      }),\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAGO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,IAAA,oIAAS;QACf,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,WAAW,EAAE,YAAY,EAAE,YAAY,EAAE,iBAAiB,EAAE,GAAG,MAAM,IAAI,IAAI;QAElH,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,QAAQ,CAAC,SAAS;YACzC,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC;gBAAE,OAAO;YAA0B,IAAI;gBACxE,QAAQ;YACV;QACF;QAEA,MAAM,iBAAiB,IAAI,yIAAW,CAAC;YACrC;YACA;YACA;YACA;YACA;YACA;YACA;YACA;QACF;QAEA,MAAM,eAAe,IAAI;QAEzB,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC;YAAE,SAAS;QAAmC,IAAI;YACnF,QAAQ;QACV;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,IAAI,SACT,KAAK,SAAS,CAAC;YACb,OAAO;YACP,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QACpD,IACA;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}