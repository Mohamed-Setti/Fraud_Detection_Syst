{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/medse/Desktop/Fraud_Detect/fraud_detection/src/lib/mongodb.ts"],"sourcesContent":[" import mongoose from \"mongoose\";\r\n\r\n const MONGODB_URI = process.env.MONGODB_URI || \"mongodb+srv://ProjetNextJs:P12QKE5OtxQR8SupXZQ9C@fdsdb.dffagbq.mongodb.net/FDS\";\r\n if (!MONGODB_URI) {\r\n    throw new Error(\"❌ Please add your MongoDB URI to .env.local\");\r\n }\r\n let isConnected = false;\r\n export async function dbConnect() {\r\n    if (isConnected) return;\r\n    try {\r\n        await mongoose.connect(MONGODB_URI);\r\n        isConnected = true;\r\n        console.log(\"✅MongoDB connected\");\r\n        console.log(`MongoDB URI: ${MONGODB_URI}`);\r\n    } catch (error) {\r\n        console.error(\"❌ MongoDB connection error\", error);\r\n        throw error;\r\n    }\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAC;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW,IAAI;AAC/C;;AAGA,IAAI,cAAc;AACX,eAAe;IACnB,IAAI,aAAa;IACjB,IAAI;QACA,MAAM,oHAAQ,CAAC,OAAO,CAAC;QACvB,cAAc;QACd,QAAQ,GAAG,CAAC;QACZ,QAAQ,GAAG,CAAC,CAAC,aAAa,EAAE,aAAa;IAC7C,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,MAAM;IACV;AACJ"}},
    {"offset": {"line": 72, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/medse/Desktop/Fraud_Detect/fraud_detection/src/Models/User.ts"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nconst UserSchema = new mongoose.Schema({\r\n  name: { type: String, required: true },\r\n  email: { type: String, required: true, unique: true },\r\n  mobile: { type: String },\r\n  passwordHash: { type: String, required: true },\r\n  role: {\r\n    type: String,\r\n    enum: [\"CLIENT\", \"TECHNICIEN\", \"ANALYSTE\", \"ADMIN\", \"analystefinanciere\"],\r\n    required: true\r\n  },\r\n  isAuthenticated: { type: Boolean, default: false },\r\n  createdAt: { type: Date, default: Date.now }\r\n});\r\n\r\nexport default mongoose.models.User || mongoose.model(\"User\", UserSchema);\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,aAAa,IAAI,oHAAQ,CAAC,MAAM,CAAC;IACrC,MAAM;QAAE,MAAM;QAAQ,UAAU;IAAK;IACrC,OAAO;QAAE,MAAM;QAAQ,UAAU;QAAM,QAAQ;IAAK;IACpD,QAAQ;QAAE,MAAM;IAAO;IACvB,cAAc;QAAE,MAAM;QAAQ,UAAU;IAAK;IAC7C,MAAM;QACJ,MAAM;QACN,MAAM;YAAC;YAAU;YAAc;YAAY;YAAS;SAAqB;QACzE,UAAU;IACZ;IACA,iBAAiB;QAAE,MAAM;QAAS,SAAS;IAAM;IACjD,WAAW;QAAE,MAAM;QAAM,SAAS,KAAK,GAAG;IAAC;AAC7C;uCAEe,oHAAQ,CAAC,MAAM,CAAC,IAAI,IAAI,oHAAQ,CAAC,KAAK,CAAC,QAAQ"}},
    {"offset": {"line": 126, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/medse/Desktop/Fraud_Detect/fraud_detection/src/app/api/auth/register/route.ts"],"sourcesContent":["import { dbConnect } from \"@/lib/mongodb\";\r\nimport User from \"@/Models/User\";\r\nimport bcrypt from \"bcryptjs\";\r\n\r\nexport async function POST(req: Request) {\r\n  try {\r\n    await dbConnect();\r\n\r\n    const { name, email, mobile, password, role } = await req.json();\r\n\r\n    if (!name || !email || !password || !role) {\r\n      return new Response(\r\n        JSON.stringify({ error: \"Missing fields\" }),\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const exists = await User.findOne({ email });\r\n    if (exists) {\r\n      return new Response(\r\n        JSON.stringify({ error: \"User already exists\" }),\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n\r\n    const passwordHash = await bcrypt.hash(password, 10);\r\n\r\n    const newUser = new User({\r\n      name,\r\n      email,\r\n      mobile: mobile || \"\",\r\n      passwordHash,\r\n      role,\r\n      isAuthenticated: false\r\n    });\r\n\r\n    await newUser.save();\r\n\r\n    return new Response(\r\n      JSON.stringify({ message: \"User registered successfully\" }),\r\n      { status: 201 }\r\n    );\r\n\r\n  } catch (error: unknown) {\r\n    return new Response(\r\n      JSON.stringify({\r\n        error: \"Something went wrong\",\r\n        details: error instanceof Error ? error.message : \"Unknown error\"\r\n      }),\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,IAAA,oIAAS;QAEf,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,IAAI;QAE9D,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,YAAY,CAAC,MAAM;YACzC,OAAO,IAAI,SACT,KAAK,SAAS,CAAC;gBAAE,OAAO;YAAiB,IACzC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,SAAS,MAAM,kIAAI,CAAC,OAAO,CAAC;YAAE;QAAM;QAC1C,IAAI,QAAQ;YACV,OAAO,IAAI,SACT,KAAK,SAAS,CAAC;gBAAE,OAAO;YAAsB,IAC9C;gBAAE,QAAQ;YAAI;QAElB;QAGA,MAAM,eAAe,MAAM,8IAAM,CAAC,IAAI,CAAC,UAAU;QAEjD,MAAM,UAAU,IAAI,kIAAI,CAAC;YACvB;YACA;YACA,QAAQ,UAAU;YAClB;YACA;YACA,iBAAiB;QACnB;QAEA,MAAM,QAAQ,IAAI;QAElB,OAAO,IAAI,SACT,KAAK,SAAS,CAAC;YAAE,SAAS;QAA+B,IACzD;YAAE,QAAQ;QAAI;IAGlB,EAAE,OAAO,OAAgB;QACvB,OAAO,IAAI,SACT,KAAK,SAAS,CAAC;YACb,OAAO;YACP,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QACpD,IACA;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}