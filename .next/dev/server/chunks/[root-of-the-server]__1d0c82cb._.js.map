{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/medse/Desktop/Fraud_Detect/fraud_detection/src/lib/mongodb.ts"],"sourcesContent":[" import mongoose from \"mongoose\";\r\n\r\n const MONGODB_URI = process.env.MONGODB_URI || \"mongodb://127.0.0.1:27017/Fraud-Detection_DB\";\r\n if (!MONGODB_URI) {\r\n    throw new Error(\"❌ Please add your MongoDB URI to .env.local\");\r\n }\r\n let isConnected = false;\r\n export async function dbConnect() {\r\n    if (isConnected) return;\r\n    try {\r\n        await mongoose.connect(MONGODB_URI);\r\n        isConnected = true;\r\n        console.log(\"✅MongoDB connected\");\r\n    } catch (error) {\r\n        console.error(\"❌ MongoDB connection error\", error);\r\n        throw error;\r\n    }\r\n}"],"names":[],"mappings":";;;;AAAC;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW,IAAI;AAC/C;;AAGA,IAAI,cAAc;AACX,eAAe;IACnB,IAAI,aAAa;IACjB,IAAI;QACA,MAAM,oHAAQ,CAAC,OAAO,CAAC;QACvB,cAAc;QACd,QAAQ,GAAG,CAAC;IAChB,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,MAAM;IACV;AACJ"}},
    {"offset": {"line": 77, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/medse/Desktop/Fraud_Detect/fraud_detection/src/Models/Transaction.ts"],"sourcesContent":["import mongoose from 'mongoose';\r\n\r\nenum TypeTransaction {\r\n  OTHER = 'OTHER',\r\n  TRANSFER = 'TRANSFER',\r\n  PAYMENT = 'PAYMENT',\r\n  WITHDRAWAL = 'WITHDRAWAL',\r\n  DEPOSIT = 'DEPOSIT'\r\n}\r\n\r\nenum StatutTransaction {\r\n  EN_ATTENTE = 'EN_ATTENTE',\r\n  VALIDE = 'VALIDE',\r\n  REJETE = 'REJETE'\r\n}\r\n\r\nconst TransactionSchema = new mongoose.Schema({\r\n  idTransaction: { type: Number },\r\n  step: { type: Number, default: 0 },\r\n  user: { type: mongoose.Schema.Types.ObjectId, ref: 'User' },\r\n  compteSource: { type: String },\r\n  compteDestination: { type: String },\r\n  date: { type: Date, required: true, default: Date.now },\r\n  amount: { type: Number, required: true },\r\n  type: { type: String, enum: Object.values(TypeTransaction), default: TypeTransaction.OTHER },\r\n  channel: { type: String, enum: ['online','branch','atm','pos','mobile'], default: 'online' },\r\n  statut: { type: String, enum: Object.values(StatutTransaction), default: StatutTransaction.EN_ATTENTE },\r\n  isFraud: { type: Boolean, default: false },\r\n  riskScore: { type: Number, default: 0 },\r\n  mlDetails: { type: mongoose.Schema.Types.Mixed },\r\n  description: { type: String },\r\n  balanceAfterSource: { type: Number },\r\n  balanceAfterDestination: { type: Number },\r\n  createdAt: { type: Date, default: Date.now }\r\n});\r\n\r\n\r\nconst Transaction = mongoose.models.Transaction || mongoose.model('Transaction', TransactionSchema);\r\nexport default Transaction;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,IAAA,AAAK,yCAAA;;;;;;WAAA;EAAA;AAQL,IAAA,AAAK,2CAAA;;;;WAAA;EAAA;AAML,MAAM,oBAAoB,IAAI,oHAAQ,CAAC,MAAM,CAAC;IAC5C,eAAe;QAAE,MAAM;IAAO;IAC9B,MAAM;QAAE,MAAM;QAAQ,SAAS;IAAE;IACjC,MAAM;QAAE,MAAM,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;IAAO;IAC1D,cAAc;QAAE,MAAM;IAAO;IAC7B,mBAAmB;QAAE,MAAM;IAAO;IAClC,MAAM;QAAE,MAAM;QAAM,UAAU;QAAM,SAAS,KAAK,GAAG;IAAC;IACtD,QAAQ;QAAE,MAAM;QAAQ,UAAU;IAAK;IACvC,MAAM;QAAE,MAAM;QAAQ,MAAM,OAAO,MAAM,CAAC;QAAkB,OAAO;IAAwB;IAC3F,SAAS;QAAE,MAAM;QAAQ,MAAM;YAAC;YAAS;YAAS;YAAM;YAAM;SAAS;QAAE,SAAS;IAAS;IAC3F,QAAQ;QAAE,MAAM;QAAQ,MAAM,OAAO,MAAM,CAAC;QAAoB,OAAO;IAA+B;IACtG,SAAS;QAAE,MAAM;QAAS,SAAS;IAAM;IACzC,WAAW;QAAE,MAAM;QAAQ,SAAS;IAAE;IACtC,WAAW;QAAE,MAAM,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK;IAAC;IAC/C,aAAa;QAAE,MAAM;IAAO;IAC5B,oBAAoB;QAAE,MAAM;IAAO;IACnC,yBAAyB;QAAE,MAAM;IAAO;IACxC,WAAW;QAAE,MAAM;QAAM,SAAS,KAAK,GAAG;IAAC;AAC7C;AAGA,MAAM,cAAc,oHAAQ,CAAC,MAAM,CAAC,WAAW,IAAI,oHAAQ,CAAC,KAAK,CAAC,eAAe;uCAClE"}},
    {"offset": {"line": 176, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/medse/Desktop/Fraud_Detect/fraud_detection/src/app/api/Client/Transaction/route.ts"],"sourcesContent":["// app/api/Client/Transaction/route.ts\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\nimport { dbConnect } from \"@/lib/mongodb\";\r\nimport Transaction from \"@/Models/Transaction\";\r\n\r\nexport async function POST(req: NextRequest) {\r\n  try {\r\n    await dbConnect();\r\n\r\n    const body = await req.json();\r\n    const {\r\n      date,\r\n      amount,\r\n      type,\r\n      channel,\r\n      description,\r\n      balanceAfter,\r\n      compteSource,\r\n      compteDestination,\r\n    } = body;\r\n\r\n    // Validation des champs obligatoires\r\n    if (!date || amount === undefined || amount === null || !type || !channel) {\r\n      return NextResponse.json(\r\n        { error: \"Missing required fields\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const parsedAmount = Number(amount);\r\n    if (Number.isNaN(parsedAmount) || parsedAmount <= 0) {\r\n      return NextResponse.json(\r\n        { error: \"Amount must be a positive number\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const parsedBalanceAfter =\r\n      balanceAfter !== undefined && balanceAfter !== \"\"\r\n        ? Number(balanceAfter)\r\n        : undefined;\r\n\r\n    const newTransaction = new Transaction({\r\n      date: new Date(date),\r\n      amount: parsedAmount,\r\n      type,\r\n      channel,\r\n      description: description || undefined,\r\n      balanceAfter: parsedBalanceAfter,\r\n      compteSource: compteSource || undefined,\r\n      compteDestination: compteDestination || undefined,\r\n    });\r\n\r\n    await newTransaction.save();\r\n\r\n    return NextResponse.json(\r\n      { message: \"Transaction created successfully\" },\r\n      { status: 201 }\r\n    );\r\n  } catch (error) {\r\n    console.error(\"Transaction error:\", error);\r\n    return NextResponse.json(\r\n      {\r\n        error: \"Something went wrong\",\r\n        details: error instanceof Error ? error.message : \"Unknown error\",\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,sCAAsC;;;;;AACtC;AACA;AACA;;;;AAEO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,IAAA,oIAAS;QAEf,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EACJ,IAAI,EACJ,MAAM,EACN,IAAI,EACJ,OAAO,EACP,WAAW,EACX,YAAY,EACZ,YAAY,EACZ,iBAAiB,EAClB,GAAG;QAEJ,qCAAqC;QACrC,IAAI,CAAC,QAAQ,WAAW,aAAa,WAAW,QAAQ,CAAC,QAAQ,CAAC,SAAS;YACzE,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA0B,GACnC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,eAAe,OAAO;QAC5B,IAAI,OAAO,KAAK,CAAC,iBAAiB,gBAAgB,GAAG;YACnD,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAmC,GAC5C;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,qBACJ,iBAAiB,aAAa,iBAAiB,KAC3C,OAAO,gBACP;QAEN,MAAM,iBAAiB,IAAI,yIAAW,CAAC;YACrC,MAAM,IAAI,KAAK;YACf,QAAQ;YACR;YACA;YACA,aAAa,eAAe;YAC5B,cAAc;YACd,cAAc,gBAAgB;YAC9B,mBAAmB,qBAAqB;QAC1C;QAEA,MAAM,eAAe,IAAI;QAEzB,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;QAAmC,GAC9C;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QACpD,GACA;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}